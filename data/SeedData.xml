<?xml version="1.0" encoding="UTF-8"?>

<entity-facade-xml type="seed">

    <!-- SystemMessageType data for Error Feed file -->
    <moqui.service.message.SystemMessageType systemMessageTypeId="FeedErrorFile"/>

    <!-- EnumerationType for OMS system message type enum and relationship -->
    <moqui.basic.EnumerationType description="OMS System Message Type Enum" enumTypeId="OMSMessageTypeEnum"/>

    <!-- TODO: Add receivePath -->
    <!-- SystemMessageType data for consuming New Products Feed -->
    <moqui.service.message.SystemMessageType systemMessageTypeId="NewProductsFeed"
            description="New Products Feed"
            parentTypeId="LocalFeedFile"
            consumeServiceName="co.hotwax.orderledger.system.FeedServices.consume#OMSFeedSystemMessage"
            receivePath="/home/${sftpUsername}/hotwax/ProductsFeed"
            receiveResponseEnumId="MsgRrMove"
            receiveMovePath="/home/${sftpUsername}/hotwax/ProductsFeed/archive"
            sendService="co.hotwax.oms.product.ProductServices.create#ProductAndVariants"
            sendPath="${contentRoot}/oms/NewProductsFeed"/>
    <moqui.basic.Enumeration description="New Products Feed" enumId="NewProductsFeed" enumTypeId="OMSMessageTypeEnum"/>

    <!-- TODO: Add receivePath -->
    <!-- SystemMessageType data for consuming Update Products Feed -->
    <moqui.service.message.SystemMessageType systemMessageTypeId="ProductUpdatesFeed"
            description="Product Updates Feed"
            parentTypeId="LocalFeedFile"
            consumeServiceName="co.hotwax.orderledger.system.FeedServices.consume#OMSFeedSystemMessage"
            receivePath="/home/${sftpUsername}/hotwax/UpdatedProductsFeed"
            receiveResponseEnumId="MsgRrMove"
            receiveMovePath="/home/${sftpUsername}/hotwax/UpdatedProductsFeed/archive"
            sendService="co.hotwax.oms.product.ProductServices.update#ProductAndVariants"
            sendPath="${contentRoot}/oms/ProductUpdatesFeed"/>
    <moqui.basic.Enumeration description="Products Updates Feed" enumId="ProductUpdatesFeed" enumTypeId="OMSMessageTypeEnum"/>

    <moqui.service.job.ServiceJob jobName="consume_AllReceivedSystemMessages_oms" description="Consume All Received SystemMessages for OMS"
            serviceName="org.moqui.impl.SystemMessageServices.consume#AllReceivedSystemMessages" cronExpression="0 0/15 * * * ?" paused="Y">
        <parameters parameterName="mode" parameterValue="sync"/>
        <parameters parameterName="systemMessageTypeIds" parameterValue="NewProductsFeed,ProductUpdatesFeed"/>
    </moqui.service.job.ServiceJob>

    <!-- New Status Item, for now used to manage Transfer Order items lifecycle and can be used for other order types if required -->
    <moqui.basic.StatusItem statusId="ITEM_PENDING_FULFILL" statusTypeId="ORDER_ITEM_STATUS" statusCode="PENDING_FULFILLMENT" description="Pending Fulfillment"/>
    <moqui.basic.StatusItem statusId="ITEM_PENDING_RECEIPT" statusTypeId="ORDER_ITEM_STATUS" statusCode="PENDING_RECEIPT" description="Pending Receipt"/>

    <!-- Status Flow for Order Items Pending Fulfillment e.g. Transfer Orders Store to Warehouse -->
    <moqui.basic.StatusFlow statusFlowId="OrderPendingFulfill" statusTypeId="ORDER_ITEM_STATUS" description="Status Flow for Orders Pending Fulfillment in OMS and Receiving by third party e.g. Transfer Orders Store to Warehouse"/>
    <moqui.basic.StatusFlowTransition statusFlowId="OrderPendingFulfill" statusId="ITEM_CREATED" toStatusId="ITEM_PENDING_FULFILL" transitionSequence="1" transitionName="Pending Fulfillment Item"/>
    <moqui.basic.StatusFlowTransition statusFlowId="OrderPendingFulfill" statusId="ITEM_PENDING_FULFILL" toStatusId="ITEM_COMPLETED" transitionSequence="2" transitionName="Complete Item"/>

    <!-- Status Flow for Order Items Pending Receipt e.g. Transfer Orders Warehouse to Store -->
    <moqui.basic.StatusFlow statusFlowId="OrderPendingReceipt" statusTypeId="ORDER_ITEM_STATUS"  description="Status Flow for Orders Fulfillment by third party and Receiving Pending in OMS e.g. Transfer Orders Warehouse to Store"/>
    <moqui.basic.StatusFlowTransition statusFlowId="OrderPendingReceipt" statusId="ITEM_CREATED" toStatusId="ITEM_PENDING_RECEIPT" transitionSequence="1" transitionName="Pending Receipt Item"/>
    <moqui.basic.StatusFlowTransition statusFlowId="OrderPendingReceipt" statusId="ITEM_PENDING_RECEIPT" toStatusId="ITEM_COMPLETED" transitionSequence="2" transitionName="Complete Item"/>

    <!-- Status Flow for Order Items Pending Fulfillment And Receipt e.g. Transfer Orders Store to Store -->
    <moqui.basic.StatusFlow statusFlowId="OrderPendingFulfillReceipt" statusTypeId="ORDER_ITEM_STATUS"  description="Status Flow for Orders Pending Fulfillment and Pending Receipt in OMS eg. Transfer Orders Store to Store"/>
    <moqui.basic.StatusFlowTransition statusFlowId="OrderPendingFulfillReceipt" statusId="ITEM_CREATED" toStatusId="ITEM_PENDING_FULFILL" transitionSequence="1" transitionName="Pending Fulfillment Item"/>
    <moqui.basic.StatusFlowTransition statusFlowId="OrderPendingFulfillReceipt" statusId="ITEM_PENDING_FULFILL" toStatusId="ITEM_PENDING_RECEIPT" transitionSequence="2" transitionName="Pending Receipt Item"/>
    <moqui.basic.StatusFlowTransition statusFlowId="OrderPendingFulfillReceipt" statusId="ITEM_PENDING_RECEIPT" toStatusId="ITEM_COMPLETED" transitionSequence="3" transitionName="Complete Item"/>
</entity-facade-xml>